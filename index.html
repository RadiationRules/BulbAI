<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BulbAI</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#f8f9fa;
  --panel:#fff;
  --accent:#f7c948;
  --accent-dark:#e6bd00;
  --text:#1f1f1f;
  --muted:#6b6b6b;
}
*{box-sizing:border-box;margin:0;padding:0;}
body,html{height:100%;font-family:'Inter',sans-serif;background:var(--bg);overflow:hidden;}
a{text-decoration:none;color:var(--accent);}
a:hover{text-decoration:underline;}

/* LOGIN SCREEN */
#loginScreen{position:relative;width:100%;height:100%;display:flex;justify-content:center;align-items:center;overflow:hidden;}
#loginScreen video{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;filter:brightness(0.3);}
.login-container{position:relative;z-index:2;background:var(--panel);padding:2rem;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.15);width:100%;max-width:400px;display:flex;flex-direction:column;gap:1.5rem;}
.login-container h1{text-align:center;font-size:2rem;color:var(--text);}
.login-container p{text-align:center;color:var(--muted);font-size:0.9rem;}
.input-group{display:flex;flex-direction:column;gap:0.5rem;}
.input-group input{padding:0.75rem;border-radius:12px;border:1px solid rgba(0,0,0,0.1);font-size:1rem;}
.button{padding:0.75rem;border-radius:12px;border:none;background:var(--accent);color:#2b2b2b;font-weight:700;cursor:pointer;transition:0.3s;display:flex;align-items:center;justify-content:center;gap:0.5rem;}
.button:hover{transform:scale(1.03);}
.google-btn{background:#fff;border:1px solid #ddd;color:#000;display:flex;align-items:center;gap:8px;}
.divider{text-align:center;color:var(--muted);margin:0.5rem 0;position:relative;}
.divider::before,.divider::after{content:"";position:absolute;top:50%;width:40%;height:1px;background:rgba(0,0,0,0.1);}
.divider::before{left:0;} .divider::after{right:0;}
.tryBtn{text-align:center;font-weight:700;text-decoration:underline;cursor:pointer;color:var(--accent);}

/* MAIN APP */
#mainApp{display:none;flex-direction:column;height:100vh;width:100%;}
.app{display:grid;grid-template-columns:300px 1fr;gap:16px;height:100%;transition:0.3s;}
.sidebar{background:var(--panel);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.08);display:flex;flex-direction:column;overflow-y:auto;}
.sidebar .brand{display:flex;align-items:center;gap:12px;margin-bottom:16px;}
.sidebar .logo{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#f7c948,#ffd86b);display:flex;align-items:center;justify-content:center;font-weight:800;color:#2b2b2b;font-size:18px;}
.sidebar button{margin-bottom:12px;}
.main{display:flex;flex-direction:column;gap:12px;}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,0.08);}
.chat-window{flex:1;background:#fef8e6;border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:12px;overflow:auto;scroll-behavior:smooth;}
.composer{display:flex;gap:8px;align-items:center;padding:12px;border-radius:12px;background:#fff;}
.composer input{flex:1;padding:12px;border-radius:12px;border:1px solid rgba(0,0,0,0.1);}
.msg.user{background:linear-gradient(90deg,#ffe37f,#fff6c6);align-self:flex-end;padding:10px 14px;border-radius:14px;box-shadow:0 6px 14px rgba(0,0,0,0.03);}
.msg.bot{background:linear-gradient(90deg,#fff7e0,#fff);align-self:flex-start;padding:10px 14px;border-radius:14px;box-shadow:0 6px 14px rgba(0,0,0,0.03);}

/* PROFILE BAR */
#profileBar{position:fixed;top:0;right:0;width:50px;height:100%;background:var(--panel);box-shadow:-2px 0 12px rgba(0,0,0,0.1);display:flex;flex-direction:column;align-items:center;padding-top:20px;transition:0.3s;z-index:999;}
#profileBar img{width:36px;height:36px;border-radius:50%;cursor:pointer;}
#profileBar button{margin-top:20px;background:none;border:none;cursor:pointer;font-size:18px;}

/* SETTINGS PANEL */
#settingsPanel{position:fixed;top:0;right:-300px;width:300px;height:100%;background:var(--panel);box-shadow:-2px 0 24px rgba(0,0,0,0.15);transition:0.3s;display:flex;flex-direction:column;padding:20px;z-index:998;}
#settingsPanel h2{margin-bottom:20px;}
#settingsPanel label{margin-bottom:12px;cursor:pointer;display:flex;align-items:center;gap:8px;}
#settingsPanel button{margin-top:12px;padding:8px;border:none;border-radius:8px;cursor:pointer;}

/* DARK MODE */
body.dark-mode{background:#171412;color:#efeae0;}
body.dark-mode .chat-window,.dark-mode .sidebar,.dark-mode .composer,.dark-mode .login-container{background:#171412;color:#efeae0;}
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen">
  <video autoplay muted loop id="bgVideo">
    <source src="https://cdn.pixabay.com/vimeo/488917037/code_terminal-1920.mp4" type="video/mp4">
  </video>
  <div class="login-container">
    <h1>üí° BulbAI</h1>
    <p>Sign in to continue</p>
    <button id="googleSignInBtn" class="button google-btn">
      <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" style="height:20px;"> Sign in with Google
    </button>
    <div class="divider">OR</div>
    <div class="input-group">
      <input type="email" id="emailInput" placeholder="Email">
      <input type="password" id="passwordInput" placeholder="Password">
    </div>
    <button id="emailSignInBtn" class="button">Sign In</button>
    <button id="emailSignUpBtn" class="button">Sign Up</button>
    <p class="tryBtn" id="tryBtn">Try It Out</p>
  </div>
</div>

<!-- MAIN APP -->
<div id="mainApp">
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">üí°</div>
        <div>
          <h2 style="font-size:16px;margin:0;">BulbAI</h2>
          <div style="font-size:12px;color:#6b6b6b;">Your yellow assistant</div>
        </div>
      </div>
      <button id="newChatBtn" class="button">+ New Chat</button>
      <div id="conversationsList" style="flex:1;display:flex;flex-direction:column;gap:8px;overflow:auto;"></div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="left">
          <h2>üí° BulbAI</h2>
          <div id="convTitle" style="font-weight:700;">New Chat</div>
        </div>
      </div>
      <div id="chatWindow" class="chat-window">
        <div id="messages"></div>
      </div>
      <div class="composer">
        <input id="prompt" placeholder="Type a message...">
        <button id="attachBtn" class="button">+</button>
        <input type="file" id="fileInput" style="display:none;" accept="image/*">
        <button id="sendBtn" class="button">Send</button>
      </div>
    </main>
  </div>
</div>

<!-- PROFILE BAR -->
<div id="profileBar">
  <img id="userProfile" src="https://i.ibb.co/2NwXcMz/lightbulb.png">
  <button id="settingsBtn">‚öôÔ∏è</button>
</div>

<!-- SETTINGS PANEL -->
<div id="settingsPanel">
  <h2>Settings</h2>
  <label><input type="checkbox" id="toggleDarkMode"> Dark Mode</label>
  <button id="clearChats" style="background:#f7c948;">Clear Chats</button>
  <button id="signOutBtn" style="background:#ff6b6b;color:#fff;">Sign Out</button>
</div>

<script type="module">
// Firebase config
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCGFij1pFUVNFP63QHxEq619c9jPnskzxY",
  authDomain: "bulbai-21f09.firebaseapp.com",
  projectId: "bulbai-21f09",
  storageBucket: "bulbai-21f09.firebasestorage.app",
  messagingSenderId: "366775652166",
  appId: "1:366775652166:web:22db16f4f87f9a60625f47",
  measurementId: "G-G09FQQ53XP"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// Elements
const loginScreenEl=document.getElementById('loginScreen');
const mainAppEl=document.getElementById('mainApp');
const googleBtn=document.getElementById('googleSignInBtn');
const emailSignInBtn=document.getElementById('emailSignInBtn');
const emailSignUpBtn=document.getElementById('emailSignUpBtn');
const emailInput=document.getElementById('emailInput');
const passwordInput=document.getElementById('passwordInput');
const tryBtn=document.getElementById('tryBtn');

// Sign In Handlers
googleBtn.onclick=()=>{
  const provider=new GoogleAuthProvider();
  signInWithPopup(auth,provider)
  .then(res=>{showApp(res.user.photoURL,res.user.displayName);})
  .catch(err=>alert(err.message));
};
emailSignInBtn.onclick=()=>{
  signInWithEmailAndPassword(auth,emailInput.value,passwordInput.value)
  .then(res=>showApp(null,res.user.email))
  .catch(err=>alert(err.message));
};
emailSignUpBtn.onclick=()=>{
  createUserWithEmailAndPassword(auth,emailInput.value,passwordInput.value)
  .then(res=>showApp(null,res.user.email))
  .catch(err=>alert(err.message));
};

// Try It Out (limited)
tryBtn.onclick=()=>{showApp();};

function showApp(photo,name){
  loginScreenEl.style.display='none';
  mainAppEl.style.display='flex';
  if(photo)document.getElementById('userProfile').src=photo;
}

// Profile & Settings
const settingsBtn=document.getElementById('settingsBtn');
const settingsPanel=document.getElementById('settingsPanel');
settingsBtn.onclick=()=>{settingsPanel.style.right=(settingsPanel.style.right==='0px')?'-300px':'0px';};

const toggleDarkMode=document.getElementById('toggleDarkMode');
toggleDarkMode.onclick=()=>{
  document.body.classList.toggle('dark-mode');
};

document.getElementById('clearChats').onclick=()=>{document.getElementById('messages').innerHTML='';};
document.getElementById('signOutBtn').onclick=()=>{signOut(auth);location.reload();};

// Chat composer + file upload
document.getElementById('attachBtn').onclick=()=>{document.getElementById('fileInput').click();};
document.getElementById('fileInput').onchange=(e)=>{
  const file=e.target.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=(ev)=>{addMessage(ev.target.result,'user',true);}
    reader.readAsDataURL(file);
  }
};
document.getElementById('sendBtn').onclick=()=>{
  const val=document.getElementById('prompt').value.trim();
  if(val){addMessage(val,'user');document.getElementById('prompt').value='';}
};
function addMessage(msg,type,isImage=false){
  const container=document.createElement('div');
  container.className='msg '+type;
  if(isImage){
    const img=document.createElement('img');img.src=msg;img.style.maxWidth='200px';img.style.borderRadius='12px';
    container.appendChild(img);
  }else{container.textContent=msg;}
  document.getElementById('messages').appendChild(container);
  container.scrollIntoView({behavior:'smooth'});
}

// New chat button
document.getElementById('newChatBtn').onclick=()=>{document.getElementById('messages').innerHTML='';document.getElementById('convTitle').textContent='New Chat';};

</script>
</body>
</html>
