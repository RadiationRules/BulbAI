<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BulbAI</title>
<meta name="google-site-verification" content="89T27xrgDiNqC6Y5qkq2iwNjI6q4r4NjREIv2DMMjZs" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root {
 --bg: #ffffff;
 --panel: #ffffff;
 --accent: #f7c948;
 --accent-dark: #e6bd00;
 --text: #1f1f1f;
 --muted: #6b6b6b;
 --shadow: rgba(0,0,0,0.1);
 --radius: 12px;
}
*{box-sizing:border-box;margin:0;padding:0;}
body, html{height:100%;font-family:'Inter',sans-serif;background:var(--bg);}
a{text-decoration:none;color:var(--accent);}
a:hover{text-decoration:underline;}

/* LOGIN SCREEN */
#loginScreen{
 display:flex;
 justify-content:center;
 align-items:center;
 height:100vh;
 width:100%;
 position:relative;
 overflow:hidden;
}
#bgVideo{
 position:absolute;
 top:0; left:0; width:100%; height:100%;
 object-fit:cover;
 z-index:-1;
 filter:blur(6px) brightness(0.5);
}
.login-container{
 background: rgba(255,255,255,0.9);
 padding:2rem;
 border-radius:var(--radius);
 box-shadow:0 8px 24px var(--shadow);
 width:100%;
 max-width:400px;
 display:flex;
 flex-direction:column;
 gap:1rem;
 text-align:center;
}
.login-container h1{font-size:2rem; color:var(--text);}
.login-container p{color:var(--muted); font-size:0.9rem;}
.input-group{display:flex; flex-direction:column; gap:0.5rem;}
.input-group input{padding:0.75rem;border-radius:var(--radius);border:1px solid rgba(0,0,0,0.1);}
.button{
 padding:0.75rem;border-radius:var(--radius);border:none;background:var(--accent);color:#2b2b2b;font-weight:700;cursor:pointer;
 display:flex; justify-content:center; align-items:center; gap:0.5rem;transition:0.3s;
}
.button:hover{transform:scale(1.03);}
.google-btn{
 background:#fff;border:1px solid #ddd;color:#000;justify-content:center;
 display:flex;align-items:center;gap:8px;font-weight:500;
}
.google-btn img{height:22px;width:22px;border-radius:2px;}
.divider{position:relative;color:var(--muted);margin:0.5rem 0;}
.divider::before, .divider::after{
 content:"";
 position:absolute;
 top:50%;
 width:40%;
 height:1px;
 background:var(--shadow);
}
.divider::before{left:0;}
.divider::after{right:0;}
.tryBtn{background:none;border:none;color:var(--accent);font-weight:700;text-decoration:underline;cursor:pointer;}

/* MAIN APP */
#mainApp{
 display:none;
 grid-template-columns:320px 1fr;
 height:100vh;
 width:100%;
}
.sidebar{
 background:var(--panel);
 padding:16px;
 border-right:1px solid #ddd;
 display:flex;
 flex-direction:column;
 gap:12px;
 overflow-y:auto;
}
.sidebar.hidden{display:none;}
.conv-item{padding:8px;border-radius:8px;background:#fef8e6;display:flex;justify-content:space-between;cursor:pointer;}
.conv-item:hover{background:#fff6c6;}
.main{
 display:flex;
 flex-direction:column;
 gap:12px;
 flex:1;
 height:100%;
}
.topbar{
 display:flex;
 justify-content:space-between;
 align-items:center;
 padding:0 16px;
 height:60px;
 background:var(--panel);
 border-bottom:1px solid #ddd;
 box-shadow:0 2px 6px rgba(0,0,0,0.05);
 z-index:10;
}
#convTitle{
 font-weight:700;
 font-size:1.2rem;
 color:var(--text);
}
#userProfile{
 width:40px;
 height:40px;
 border-radius:50%;
 cursor:pointer;
 border:2px solid var(--accent);
}

/* CHAT WINDOW */
.chat-window{
 flex:1;
 background:#fef8e6;
 border-radius:12px;
 padding:16px;
 display:flex;
 flex-direction:column;
 gap:12px;
 overflow-y:auto;
 box-shadow:0 6px 18px rgba(0,0,0,0.08);
 scroll-behavior:smooth;
 margin:0 16px;
}
.composer{
 display:flex;
 gap:8px;
 align-items:center;
 margin:8px 16px 16px 16px;
}
.composer input{
 flex:1;
 padding:12px;
 border-radius:12px;
 border:1px solid rgba(0,0,0,0.1);
 font-size:1rem;
}
.msg{
 opacity:0;
 transform: translateY(10px);
 transition: all 0.3s ease;
}
.msg.show{
 opacity:1;
 transform: translateY(0);
}
.msg.user{background:linear-gradient(90deg,#ffe37f,#fff6c6);align-self:flex-end;padding:10px 14px;border-radius:14px;max-width:70%;}
.msg.bot{background:linear-gradient(90deg,#fff7e0,#fff);align-self:flex-start;padding:10px 14px;border-radius:14px;max-width:70%;}

/* PROFILE DROPDOWN */
#profileMenu{display:none;position:absolute;top:70px;right:16px;background:var(--panel);border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.2);overflow:hidden;min-width:160px;z-index:1000;}
#profileMenu button{width:100%;border:none;padding:10px;background:none;cursor:pointer;text-align:left;}
#profileMenu button:hover{background:var(--accent);color:#2b2b2b;}

/* DARK MODE */
body.dark-mode{
 --bg:#1f1f1f;
 --panel:#2b2b2b;
 --text:#f0f0f0;
 --accent:#f7c948;
}
body.dark-mode .chat-window{background:#2b2b2b;}
</style>
</head>
<body>

<video id="bgVideo" autoplay muted loop playsinline>
 <source src="https://cdn.videvo.net/videvo_files/video/free/2019-08/large_watermarked/190725_01_Software_1080p_029_preview.mp4" type="video/mp4">
</video>

<div id="loginScreen">
 <div class="login-container">
   <h1>ðŸ’¡ BulbAI</h1>
   <p>Sign in to continue</p>
   <button id="googleSignInBtn" class="button google-btn">
     <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google"> Sign in with Google
   </button>
   <div class="divider">OR</div>
   <div class="input-group">
     <input type="email" id="emailInput" placeholder="Email">
     <input type="password" id="passwordInput" placeholder="Password">
   </div>
   <button id="emailSignInBtn" class="button">Sign In</button>
   <button id="emailSignUpBtn" class="button">Sign Up</button>
   <button id="tryBtn" class="tryBtn">Try it out</button>
 </div>
</div>

<div id="mainApp">
 <div id="sidebar" class="sidebar">
   <button id="newChatBtn" class="button">+ New Chat</button>
   <div id="conversationsList"></div>
 </div>

 <div class="main">
   <div class="topbar">
     <div id="convTitle">New Chat</div>
     <img id="userProfile" src="" alt="Profile">
   </div>
   <div id="messages" class="chat-window"></div>
   <div class="composer">
     <input id="prompt" placeholder="Type a message...">
     <button id="attachBtn" class="button">+</button>
     <input type="file" id="fileInput" style="display:none;">
     <button id="sendBtn" class="button">Send</button>
   </div>
 </div>
</div>

<div id="profileMenu">
 <button id="profileToggleTheme">Toggle Dark/Light</button>
 <button id="profileClearChats">Clear Conversations</button>
 <button id="signOutBtn">Sign Out</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

const firebaseConfig = {
 apiKey: "AIzaSyCGFij1pFUVNFP63QHxEq619c9jPnskzxY",
 authDomain: "bulbai-21f09.firebaseapp.com",
 projectId: "bulbai-21f09",
 storageBucket: "bulbai-21f09.firebasestorage.app",
 messagingSenderId: "366775652166",
 appId: "1:366775652166:web:22db16f4f87f9a60625f47",
 measurementId: "G-G09FQQ53XP"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const loginScreen = document.getElementById('loginScreen');
const mainApp = document.getElementById('mainApp');
const googleSignInBtn = document.getElementById('googleSignInBtn');
const tryBtn = document.getElementById('tryBtn');
const userProfile = document.getElementById('userProfile');
const profileMenu = document.getElementById('profileMenu');
const profileToggleTheme = document.getElementById('profileToggleTheme');
const profileClearChats = document.getElementById('profileClearChats');
const signOutBtn = document.getElementById('signOutBtn');

auth.onAuthStateChanged(user=>{
 if(user){
   loginScreen.style.display='none';
   mainApp.style.display='grid';
   userProfile.src = user.photoURL || 'https://upload.wikimedia.org/wikipedia/commons/4/4a/Logo_2013_Google.png';
   userProfile.style.display='block';
 }
});

googleSignInBtn.onclick = async ()=>{
 const provider = new GoogleAuthProvider();
 try{ await signInWithPopup(auth,provider); }catch(e){alert(e.message);}
}

tryBtn.onclick = ()=>{
 loginScreen.style.display='none';
 mainApp.style.display='grid';
}

userProfile.onclick = ()=> profileMenu.style.display = profileMenu.style.display==='block'?'none':'block';
window.onclick = e=>{if(!userProfile.contains(e.target)&&!profileMenu.contains(e.target)){profileMenu.style.display='none';}}
profileToggleTheme.onclick = ()=>document.body.classList.toggle('dark-mode');
profileClearChats.onclick = ()=>document.getElementById('messages').innerHTML='';
signOutBtn.onclick = async ()=>{await signOut(auth);location.reload();}

const messages = document.getElementById('messages');
const sendBtn = document.getElementById('sendBtn');
const prompt = document.getElementById('prompt');
const attachBtn = document.getElementById('attachBtn');
const fileInput = document.getElementById('fileInput');

function addMessage(el){messages.appendChild(el);setTimeout(()=>el.classList.add('show'),10);messages.scrollTop=messages.scrollHeight;}

async function sendMessage(){
 if(prompt.value.trim()==='') return;
 const userMsg=document.createElement('div');
 userMsg.className='msg user';
 userMsg.textContent=prompt.value;
 addMessage(userMsg);

 try{
   const res=await fetch('https://api.chatbase.co/v1/conversation',{
     method:'POST',
     headers:{
       'Content-Type':'application/json',
       'Authorization':'Bearer yato30hkcyj96s3whclhywxppb44fuf5'
     },
     body:JSON.stringify({messages:[{type:'text',role:'user',text:prompt.value}],model:'gpt-3.5-turbo'})
   });
   const data=await res.json();
   const botMsg=document.createElement('div');
   botMsg.className='msg bot';
   botMsg.textContent=data.messages?.[0]?.text||'No response from AI.';
   addMessage(botMsg);
 }catch(e){
   const botMsg=document.createElement('div');
   botMsg.className='msg bot';
   botMsg.textContent='Error connecting to AI: '+e.message;
   addMessage(botMsg);
 }
 prompt.value='';
}

sendBtn.onclick=sendMessage;
prompt.addEventListener('keydown',e=>{
 if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage();}
});

attachBtn.onclick = ()=>fileInput.click();
fileInput.onchange = e=>{
 const file = e.target.files[0];
 if(file){
   const msg = document.createElement('div');
   msg.className='msg user';
   msg.textContent=`[Image attached: ${file.name}]`;
   addMessage(msg);
 }
}
</script>
</body>
</html>
